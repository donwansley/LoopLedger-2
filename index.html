<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LoopLedger - Connect Your Music Accounts</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .music-gradient {
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4, #45b7d1, #96ceb4, #feca57);
            background-size: 300% 300%;
            animation: gradient 8s ease infinite;
        }
        @keyframes gradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        .connection-card {
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }
        .connection-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
        }
        .connected {
            border-color: #10b981;
            background: linear-gradient(135deg, #ecfdf5 0%, #f0fdf4 100%);
        }
        .disconnected {
            border-color: #e5e7eb;
        }
        .oauth-flow {
            display: none;
        }
        .oauth-flow.active {
            display: block;
        }
        .platform-spotify { color: #1db954; }
        .platform-youtube { color: #ff0000; }
        .platform-apple { color: #fa243c; }
        .platform-soundexchange { color: #0066cc; }
        .platform-ascap { color: #003d7a; }
        .platform-bmi { color: #e31837; }
        .platform-mlc { color: #8b5a2b; }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Navigation -->
    <nav class="bg-white shadow-lg sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <div class="flex-shrink-0 flex items-center">
                        <i class="fas fa-infinity text-3xl music-gradient bg-clip-text text-transparent mr-3"></i>
                        <span class="text-xl font-bold text-gray-900">LoopLedger</span>
                    </div>
                    <div class="hidden md:ml-10 md:flex md:space-x-8">
                        <a href="#dashboard" class="nav-link text-indigo-600 font-medium">Dashboard</a>
                        <a href="#integrations" class="nav-link text-gray-500 hover:text-gray-900">Integrations</a>
                        <a href="#songs" class="nav-link text-gray-500 hover:text-gray-900">Songs</a>
                        <a href="#reports" class="nav-link text-gray-500 hover:text-gray-900">Reports</a>
                        <a href="#support" class="nav-link text-gray-500 hover:text-gray-900">Support</a>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <button class="bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 transition">
                        <i class="fas fa-plus mr-2"></i>Add Song
                    </button>
                    <div class="h-8 w-8 bg-indigo-600 rounded-full flex items-center justify-center text-white font-medium">
                        U
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8">
        <!-- Header -->
        <div class="mb-8">
            <h1 class="text-3xl font-bold text-gray-900">Connect Your Music Accounts</h1>
            <p class="mt-2 text-gray-600">Link your accounts to start tracking royalties from all your music platforms.</p>
        </div>

        <!-- Connection Status Overview -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
            <div class="bg-white rounded-lg shadow p-6">
                <div class="flex items-center">
                    <div class="flex-shrink-0">
                        <i class="fas fa-link text-2xl text-green-500"></i>
                    </div>
                    <div class="ml-4">
                        <p class="text-sm font-medium text-gray-500">Connected Platforms</p>
                        <p class="text-2xl font-semibold text-gray-900" id="connected-count">3</p>
                    </div>
                </div>
            </div>
            <div class="bg-white rounded-lg shadow p-6">
                <div class="flex items-center">
                    <div class="flex-shrink-0">
                        <i class="fas fa-dollar-sign text-2xl text-blue-500"></i>
                    </div>
                    <div class="ml-4">
                        <p class="text-sm font-medium text-gray-500">Total Tracked Earnings</p>
                        <p class="text-2xl font-semibold text-gray-900">$2,847.32</p>
                    </div>
                </div>
            </div>
            <div class="bg-white rounded-lg shadow p-6">
                <div class="flex items-center">
                    <div class="flex-shrink-0">
                        <i class="fas fa-music text-2xl text-purple-500"></i>
                    </div>
                    <div class="ml-4">
                        <p class="text-sm font-medium text-gray-500">Tracked Songs</p>
                        <p class="text-2xl font-semibold text-gray-900">47</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Platform Integrations -->
        <div class="bg-white rounded-lg shadow-lg">
            <div class="px-6 py-4 border-b border-gray-200">
                <h2 class="text-xl font-semibold text-gray-900">Platform Integrations</h2>
                <p class="mt-1 text-sm text-gray-600">Connect your accounts to automatically sync royalty data</p>
            </div>
            <div class="p-6">
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    
                    <!-- Spotify Integration -->
                    <div class="connection-card bg-white rounded-lg p-6 connected" data-platform="spotify">
                        <div class="flex items-center justify-between mb-4">
                            <div class="flex items-center">
                                <i class="fab fa-spotify text-3xl platform-spotify"></i>
                                <div class="ml-3">
                                    <h3 class="text-lg font-medium text-gray-900">Spotify</h3>
                                    <p class="text-sm text-gray-500">Streaming Data</p>
                                </div>
                            </div>
                            <span class="bg-green-100 text-green-800 text-xs font-medium px-2.5 py-0.5 rounded-full">Connected</span>
                        </div>
                        <p class="text-sm text-gray-600 mb-4">Track streams, listeners, and metadata from Spotify.</p>
                        <button class="w-full bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700 transition" onclick="disconnectPlatform('spotify')">
                            <i class="fas fa-unlink mr-2"></i>Disconnect
                        </button>
                        <p class="text-xs text-gray-500 mt-2">Last sync: 2 hours ago</p>
                    </div>

                    <!-- YouTube Integration -->
                    <div class="connection-card bg-white rounded-lg p-6 connected" data-platform="youtube">
                        <div class="flex items-center justify-between mb-4">
                            <div class="flex items-center">
                                <i class="fab fa-youtube text-3xl platform-youtube"></i>
                                <div class="ml-3">
                                    <h3 class="text-lg font-medium text-gray-900">YouTube</h3>
                                    <p class="text-sm text-gray-500">Content ID & Analytics</p>
                                </div>
                            </div>
                            <span class="bg-green-100 text-green-800 text-xs font-medium px-2.5 py-0.5 rounded-full">Connected</span>
                        </div>
                        <p class="text-sm text-gray-600 mb-4">Revenue from YouTube Content ID and video analytics.</p>
                        <button class="w-full bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700 transition" onclick="disconnectPlatform('youtube')">
                            <i class="fas fa-unlink mr-2"></i>Disconnect
                        </button>
                        <p class="text-xs text-gray-500 mt-2">Last sync: 1 hour ago</p>
                    </div>

                    <!-- Apple Music Integration -->
                    <div class="connection-card bg-white rounded-lg p-6 disconnected" data-platform="apple">
                        <div class="flex items-center justify-between mb-4">
                            <div class="flex items-center">
                                <i class="fab fa-apple text-3xl platform-apple"></i>
                                <div class="ml-3">
                                    <h3 class="text-lg font-medium text-gray-900">Apple Music</h3>
                                    <p class="text-sm text-gray-500">Streaming Analytics</p>
                                </div>
                            </div>
                            <span class="bg-gray-100 text-gray-800 text-xs font-medium px-2.5 py-0.5 rounded-full">Not Connected</span>
                        </div>
                        <p class="text-sm text-gray-600 mb-4">Connect Apple Music for Artists for streaming data.</p>
                        <button class="w-full bg-red-600 text-white py-2 px-4 rounded-lg hover:bg-red-700 transition" onclick="connectPlatform('apple')">
                            <i class="fas fa-link mr-2"></i>Connect
                        </button>
                    </div>

                    <!-- MLC Integration -->
                    <div class="connection-card bg-white rounded-lg p-6 connected" data-platform="mlc">
                        <div class="flex items-center justify-between mb-4">
                            <div class="flex items-center">
                                <i class="fas fa-file-contract text-3xl platform-mlc"></i>
                                <div class="ml-3">
                                    <h3 class="text-lg font-medium text-gray-900">The MLC</h3>
                                    <p class="text-sm text-gray-500">Mechanical Royalties</p>
                                </div>
                            </div>
                            <span class="bg-green-100 text-green-800 text-xs font-medium px-2.5 py-0.5 rounded-full">Connected</span>
                        </div>
                        <p class="text-sm text-gray-600 mb-4">Mechanical Licensing Collective for digital mechanical royalties.</p>
                        <button class="w-full bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700 transition" onclick="disconnectPlatform('mlc')">
                            <i class="fas fa-unlink mr-2"></i>Disconnect
                        </button>
                        <p class="text-xs text-gray-500 mt-2">Last sync: 4 hours ago</p>
                    </div>

                    <!-- ASCAP Integration -->
                    <div class="connection-card bg-white rounded-lg p-6 disconnected" data-platform="ascap">
                        <div class="flex items-center justify-between mb-4">
                            <div class="flex items-center">
                                <i class="fas fa-music text-3xl platform-ascap"></i>
                                <div class="ml-3">
                                    <h3 class="text-lg font-medium text-gray-900">ASCAP</h3>
                                    <p class="text-sm text-gray-500">Performance Royalties</p>
                                </div>
                            </div>
                            <span class="bg-yellow-100 text-yellow-800 text-xs font-medium px-2.5 py-0.5 rounded-full">Manual Import</span>
                        </div>
                        <p class="text-sm text-gray-600 mb-4">Import ASCAP statements manually or via CSV upload.</p>
                        <button class="w-full bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition" onclick="connectPlatform('ascap')">
                            <i class="fas fa-upload mr-2"></i>Import Data
                        </button>
                    </div>

                    <!-- BMI Integration -->
                    <div class="connection-card bg-white rounded-lg p-6 disconnected" data-platform="bmi">
                        <div class="flex items-center justify-between mb-4">
                            <div class="flex items-center">
                                <i class="fas fa-broadcast-tower text-3xl platform-bmi"></i>
                                <div class="ml-3">
                                    <h3 class="text-lg font-medium text-gray-900">BMI</h3>
                                    <p class="text-sm text-gray-500">Performance Royalties</p>
                                </div>
                            </div>
                            <span class="bg-yellow-100 text-yellow-800 text-xs font-medium px-2.5 py-0.5 rounded-full">Manual Import</span>
                        </div>
                        <p class="text-sm text-gray-600 mb-4">Import BMI statements manually or via CSV upload.</p>
                        <button class="w-full bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition" onclick="connectPlatform('bmi')">
                            <i class="fas fa-upload mr-2"></i>Import Data
                        </button>
                    </div>

                    <!-- SoundExchange Integration -->
                    <div class="connection-card bg-white rounded-lg p-6 disconnected" data-platform="soundexchange">
                        <div class="flex items-center justify-between mb-4">
                            <div class="flex items-center">
                                <i class="fas fa-radio text-3xl platform-soundexchange"></i>
                                <div class="ml-3">
                                    <h3 class="text-lg font-medium text-gray-900">SoundExchange</h3>
                                    <p class="text-sm text-gray-500">Digital Performance</p>
                                </div>
                            </div>
                            <span class="bg-gray-100 text-gray-800 text-xs font-medium px-2.5 py-0.5 rounded-full">Not Connected</span>
                        </div>
                        <p class="text-sm text-gray-600 mb-4">Digital performance royalties from satellite and internet radio.</p>
                        <button class="w-full bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition" onclick="connectPlatform('soundexchange')">
                            <i class="fas fa-link mr-2"></i>Connect
                        </button>
                    </div>

                    <!-- DistroKid Integration -->
                    <div class="connection-card bg-white rounded-lg p-6 disconnected" data-platform="distrokid">
                        <div class="flex items-center justify-between mb-4">
                            <div class="flex items-center">
                                <i class="fas fa-compact-disc text-3xl text-orange-500"></i>
                                <div class="ml-3">
                                    <h3 class="text-lg font-medium text-gray-900">DistroKid</h3>
                                    <p class="text-sm text-gray-500">Distribution Analytics</p>
                                </div>
                            </div>
                            <span class="bg-gray-100 text-gray-800 text-xs font-medium px-2.5 py-0.5 rounded-full">Not Connected</span>
                        </div>
                        <p class="text-sm text-gray-600 mb-4">Connect your DistroKid account for distribution analytics.</p>
                        <button class="w-full bg-orange-600 text-white py-2 px-4 rounded-lg hover:bg-orange-700 transition" onclick="connectPlatform('distrokid')">
                            <i class="fas fa-link mr-2"></i>Connect
                        </button>
                    </div>

                    <!-- CD Baby Integration -->
                    <div class="connection-card bg-white rounded-lg p-6 disconnected" data-platform="cdbaby">
                        <div class="flex items-center justify-between mb-4">
                            <div class="flex items-center">
                                <i class="fas fa-baby text-3xl text-blue-400"></i>
                                <div class="ml-3">
                                    <h3 class="text-lg font-medium text-gray-900">CD Baby</h3>
                                    <p class="text-sm text-gray-500">Distribution & Publishing</p>
                                </div>
                            </div>
                            <span class="bg-gray-100 text-gray-800 text-xs font-medium px-2.5 py-0.5 rounded-full">Not Connected</span>
                        </div>
                        <p class="text-sm text-gray-600 mb-4">Connect CD Baby for distribution and publishing data.</p>
                        <button class="w-full bg-blue-400 text-white py-2 px-4 rounded-lg hover:bg-blue-500 transition" onclick="connectPlatform('cdbaby')">
                            <i class="fas fa-link mr-2"></i>Connect
                        </button>
                    </div>

                </div>
            </div>
        </div>

        <!-- OAuth Flow Modals -->
        <div id="oauth-modal" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full hidden z-50">
            <div class="relative top-20 mx-auto p-5 border w-11/12 md:w-3/4 lg:w-1/2 shadow-lg rounded-md bg-white">
                <div class="mt-3">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-lg font-medium text-gray-900" id="modal-title">Connect Platform</h3>
                        <button onclick="closeModal()" class="text-gray-400 hover:text-gray-600">
                            <i class="fas fa-times text-xl"></i>
                        </button>
                    </div>
                    <div id="modal-content">
                        <!-- Content will be dynamically inserted here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Integration Instructions -->
        <div class="mt-8 bg-blue-50 border border-blue-200 rounded-lg p-6">
            <div class="flex">
                <div class="flex-shrink-0">
                    <i class="fas fa-info-circle text-blue-400 text-xl"></i>
                </div>
                <div class="ml-3">
                    <h3 class="text-sm font-medium text-blue-800">Integration Help</h3>
                    <div class="mt-2 text-sm text-blue-700">
                        <ul class="list-disc pl-5 space-y-1">
                            <li><strong>Spotify & YouTube:</strong> Full API access available for real-time data</li>
                            <li><strong>MLC:</strong> Beta API access for mechanical royalty tracking</li>
                            <li><strong>ASCAP & BMI:</strong> Manual import until APIs become available</li>
                            <li><strong>SoundExchange:</strong> Working on API integration - manual import for now</li>
                            <li><strong>Need help?</strong> Contact our integration team for assistance</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <!-- LoopBot Chat Assistant -->
    <div id="loopbot-container" class="fixed bottom-6 right-6 z-50">
        <div id="loopbot-chat" class="hidden bg-white rounded-lg shadow-xl w-80 h-96 flex flex-col">
            <div class="bg-indigo-600 text-white p-4 rounded-t-lg flex items-center justify-between">
                <div class="flex items-center">
                    <i class="fas fa-robot mr-2"></i>
                    <span class="font-medium">LoopBot Assistant</span>
                </div>
                <button onclick="toggleChat()" class="text-white hover:text-gray-200">
                    <i class="fas fa-minus"></i>
                </button>
            </div>
            <div class="flex-1 p-4 overflow-y-auto" id="chat-messages">
                <div class="text-sm text-gray-600 mb-3">
                    <strong>LoopBot:</strong> Hi! I can help you connect your music accounts. Which platform would you like to integrate first?
                </div>
            </div>
            <div class="p-4 border-t">
                <div class="flex">
                    <input type="text" id="chat-input" placeholder="Ask about integrations..." class="flex-1 border border-gray-300 rounded-l-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500">
                    <button onclick="sendMessage()" class="bg-indigo-600 text-white px-4 py-2 rounded-r-lg hover:bg-indigo-700">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>
        </div>
        <button id="loopbot-toggle" onclick="toggleChat()" class="bg-indigo-600 text-white w-14 h-14 rounded-full shadow-lg hover:bg-indigo-700 transition flex items-center justify-center">
            <i class="fas fa-robot text-xl"></i>
        </button>
    </div>

    <script>
        // Platform connection states
        let connectedPlatforms = ['spotify', 'youtube', 'mlc'];

        // OAuth flow configurations
        const platformConfigs = {
            spotify: {
                name: 'Spotify',
                clientId: 'your_spotify_client_id',
                redirectUri: window.location.origin + '/auth/spotify',
                scopes: ['user-read-private', 'user-read-email'],
                authUrl: 'https://accounts.spotify.com/authorize'
            },
            youtube: {
                name: 'YouTube',
                clientId: 'your_youtube_client_id',
                redirectUri: window.location.origin + '/auth/youtube',
                scopes: ['https://www.googleapis.com/auth/youtube.readonly', 'https://www.googleapis.com/auth/yt-analytics.readonly'],
                authUrl: 'https://accounts.google.com/o/oauth2/v2/auth'
            },
            apple: {
                name: 'Apple Music',
                type: 'manual',
                instructions: 'Apple Music integration requires MusicKit setup. Contact support for assistance.'
            },
            mlc: {
                name: 'The MLC',
                type: 'api',
                instructions: 'MLC integration uses their Public Search API. Credentials configured automatically.'
            },
            ascap: {
                name: 'ASCAP',
                type: 'manual',
                instructions: 'ASCAP requires manual statement import. Download CSV from your ASCAP account.'
            },
            bmi: {
                name: 'BMI',
                type: 'manual',
                instructions: 'BMI requires manual statement import. Download CSV from your BMI account.'
            },
            soundexchange: {
                name: 'SoundExchange',
                type: 'manual',
                instructions: 'SoundExchange integration coming soon. Manual import available.'
            },
            distrokid: {
                name: 'DistroKid',
                type: 'oauth',
                instructions: 'Connect your DistroKid account for distribution analytics.'
            },
            cdbaby: {
                name: 'CD Baby',
                type: 'oauth',
                instructions: 'Connect your CD Baby account for distribution and publishing data.'
            }
        };

        function connectPlatform(platform) {
            const config = platformConfigs[platform];
            
            if (config.type === 'oauth' || config.authUrl) {
                showOAuthFlow(platform);
            } else if (config.type === 'manual') {
                showManualImport(platform);
            } else {
                showConnectionInstructions(platform);
            }
        }

        function disconnectPlatform(platform) {
            if (confirm(`Are you sure you want to disconnect ${platformConfigs[platform].name}?`)) {
                // Update UI
                const card = document.querySelector(`[data-platform="${platform}"]`);
                card.classList.remove('connected');
                card.classList.add('disconnected');
                
                const status = card.querySelector('span');
                status.textContent = 'Not Connected';
                status.className = 'bg-gray-100 text-gray-800 text-xs font-medium px-2.5 py-0.5 rounded-full';
                
                const button = card.querySelector('button');
                button.innerHTML = '<i class="fas fa-link mr-2"></i>Connect';
                button.className = 'w-full bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition';
                button.onclick = () => connectPlatform(platform);
                
                // Remove last sync info
                const syncInfo = card.querySelector('.text-xs.text-gray-500');
                if (syncInfo) syncInfo.remove();
                
                // Update connected count
                connectedPlatforms = connectedPlatforms.filter(p => p !== platform);
                document.getElementById('connected-count').textContent = connectedPlatforms.length;
                
                showNotification(`Disconnected from ${platformConfigs[platform].name}`, 'success');
            }
        }

        function showOAuthFlow(platform) {
            const config = platformConfigs[platform];
            const modalContent = document.getElementById('modal-content');
            const modalTitle = document.getElementById('modal-title');
            
            modalTitle.textContent = `Connect ${config.name}`;
            
            if (config.authUrl) {
                modalContent.innerHTML = `
                    <div class="space-y-4">
                        <div class="text-center">
                            <i class="fas fa-shield-alt text-4xl text-green-500 mb-4"></i>
                            <h4 class="text-lg font-medium text-gray-900 mb-2">Secure OAuth Connection</h4>
                            <p class="text-sm text-gray-600 mb-6">You'll be redirected to ${config.name} to authorize LoopLedger to access your account data.</p>
                        </div>
                        
                        <div class="bg-gray-50 rounded-lg p-4">
                            <h5 class="font-medium text-gray-900 mb-2">What we'll access:</h5>
                            <ul class="text-sm text-gray-600 space-y-1">
                                <li><i class="fas fa-check text-green-500 mr-2"></i>Basic account information</li>
                                <li><i class="fas fa-check text-green-500 mr-2"></i>Streaming and revenue data</li>
                                <li><i class="fas fa-check text-green-500 mr-2"></i>Song metadata and analytics</li>
                                <li><i class="fas fa-times text-red-500 mr-2"></i>We will NOT access personal data</li>
                            </ul>
                        </div>
                        
                        <div class="flex space-x-3">
                            <button onclick="closeModal()" class="flex-1 bg-gray-300 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-400 transition">
                                Cancel
                            </button>
                            <button onclick="initiateOAuth('${platform}')" class="flex-1 bg-indigo-600 text-white py-2 px-4 rounded-lg hover:bg-indigo-700 transition">
                                <i class="fas fa-external-link-alt mr-2"></i>Connect Now
                            </button>
                        </div>
                    </div>
                `;
            } else {
                modalContent.innerHTML = `
                    <div class="text-center space-y-4">
                        <i class="fas fa-tools text-4xl text-blue-500"></i>
                        <h4 class="text-lg font-medium text-gray-900">Integration Setup Required</h4>
                        <p class="text-sm text-gray-600">${config.instructions}</p>
                        <button onclick="closeModal()" class="bg-blue-600 text-white py-2 px-6 rounded-lg hover:bg-blue-700 transition">
                            Got it
                        </button>
                    </div>
                `;
            }
            
            document.getElementById('oauth-modal').classList.remove('hidden');
        }

        function showManualImport(platform) {
            const config = platformConfigs[platform];
            const modalContent = document.getElementById('modal-content');
            const modalTitle = document.getElementById('modal-title');
            
            modalTitle.textContent = `Import ${config.name} Data`;
            
            modalContent.innerHTML = `
                <div class="space-y-4">
                    <div class="text-center">
                        <i class="fas fa-upload text-4xl text-blue-500 mb-4"></i>
                        <h4 class="text-lg font-medium text-gray-900 mb-2">Manual Data Import</h4>
                        <p class="text-sm text-gray-600 mb-6">${config.instructions}</p>
                    </div>
                    
                    <div class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center">
                        <i class="fas fa-file-csv text-3xl text-gray-400 mb-2"></i>
                        <p class="text-sm text-gray-600 mb-4">Drag and drop your CSV file here, or click to browse</p>
                        <input type="file" id="file-upload" accept=".csv,.xlsx,.xls" class="hidden" onchange="handleFileUpload(event, '${platform}')">
                        <button onclick="document.getElementById('file-upload').click()" class="bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition">
                            <i class="fas fa-folder-open mr-2"></i>Choose File
                        </button>
                    </div>
                    
                    <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                        <div class="flex">
                            <i class="fas fa-info-circle text-yellow-400 mr-2 mt-0.5"></i>
                            <div class="text-sm text-yellow-700">
                                <strong>Supported formats:</strong> CSV, Excel (.xlsx, .xls)<br>
                                <strong>Data included:</strong> Royalty statements, payment history, song performance
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex space-x-3">
                        <button onclick="closeModal()" class="flex-1 bg-gray-300 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-400 transition">
                            Cancel
                        </button>
                        <button onclick="showImportInstructions('${platform}')" class="flex-1 bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700 transition">
                            <i class="fas fa-question-circle mr-2"></i>How to Export
                        </button>
                    </div>
                </div>
            `;
            
            document.getElementById('oauth-modal').classList.remove('hidden');
        }

        function showConnectionInstructions(platform) {
            const config = platformConfigs[platform];
            const modalContent = document.getElementById('modal-content');
            const modalTitle = document.getElementById('modal-title');
            
            modalTitle.textContent = `Setup ${config.name}`;
            
            modalContent.innerHTML = `
                <div class="space-y-4">
                    <div class="text-center">
                        <i class="fas fa-cog text-4xl text-indigo-500 mb-4"></i>
                        <h4 class="text-lg font-medium text-gray-900 mb-2">Integration Setup</h4>
                        <p class="text-sm text-gray-600 mb-6">${config.instructions}</p>
                    </div>
                    
                    <div class="bg-indigo-50 border border-indigo-200 rounded-lg p-4">
                        <h5 class="font-medium text-indigo-900 mb-2">Next Steps:</h5>
                        <ol class="text-sm text-indigo-700 space-y-1 list-decimal list-inside">
                            <li>Contact our integration team</li>
                            <li>Provide your account credentials securely</li>
                            <li>We'll configure the connection for you</li>
                            <li>Start receiving automated updates</li>
                        </ol>
                    </div>
                    
                    <div class="flex space-x-3">
                        <button onclick="closeModal()" class="flex-1 bg-gray-300 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-400 transition">
                            Maybe Later
                        </button>
                        <button onclick="contactSupport('${platform}')" class="flex-1 bg-indigo-600 text-white py-2 px-4 rounded-lg hover:bg-indigo-700 transition">
                            <i class="fas fa-headset mr-2"></i>Contact Support
                        </button>
                    </div>
                </div>
            `;
            
            document.getElementById('oauth-modal').classList.remove('hidden');
        }

        function initiateOAuth(platform) {
            const config = platformConfigs[platform];
            
            if (config.authUrl) {
                const params = new URLSearchParams({
                    client_id: config.clientId,
                    response_type: 'code',
                    redirect_uri: config.redirectUri,
                    scope: Array.isArray(config.scopes) ? config.scopes.join(' ') : config.scopes,
                    state: platform
                });
                
                const authUrl = `${config.authUrl}?${params.toString()}`;
                
                // In a real app, this would redirect to the OAuth provider
                // For demo purposes, we'll simulate a successful connection
                simulateSuccessfulConnection(platform);
            }
        }

        function simulateSuccessfulConnection(platform) {
            closeModal();
            
            // Show loading state
            showNotification(`Connecting to ${platformConfigs[platform].name}...`, 'info');
            
            setTimeout(() => {
                // Update UI to show connected state
                const card = document.querySelector(`[data-platform="${platform}"]`);
                card.classList.remove('disconnected');
                card.classList.add('connected');
                
                const status = card.querySelector('span');
                status.textContent = 'Connected';
                status.className = 'bg-green-100 text-green-800 text-xs font-medium px-2.5 py-0.5 rounded-full';
                
                const button = card.querySelector('button');
                button.innerHTML = '<i class="fas fa-unlink mr-2"></i>Disconnect';
                button.className = 'w-full bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700 transition';
                button.onclick = () => disconnectPlatform(platform);
                
                // Add sync info
                const syncInfo = document.createElement('p');
                syncInfo.className = 'text-xs text-gray-500 mt-2';
                syncInfo.textContent = 'Last sync: Just now';
                card.appendChild(syncInfo);
                
                // Update connected count
                if (!connectedPlatforms.includes(platform)) {
                    connectedPlatforms.push(platform);
                }
                document.getElementById('connected-count').textContent = connectedPlatforms.length;
                
                showNotification(`Successfully connected to ${platformConfigs[platform].name}!`, 'success');
            }, 2000);
        }

        function handleFileUpload(event, platform) {
            const file = event.target.files[0];
            if (file) {
                showNotification(`Uploading ${file.name}...`, 'info');
                
                // Simulate file processing
                setTimeout(() => {
                    closeModal();
                    showNotification(`Successfully imported data from ${platformConfigs[platform].name}!`, 'success');
                    
                    // Update connection status
                    simulateSuccessfulConnection(platform);
                }, 3000);
            }
        }

        function showImportInstructions(platform) {
            const instructions = {
                ascap: {
                    steps: [
                        'Log in to your ASCAP Member Access account',
                        'Navigate to "Royalty Statements"',
                        'Select the date range you want to export',
                        'Click "Download" and choose CSV format',
                        'Upload the downloaded file here'
                    ],
                    url: 'https://www.ascap.com/memberaccess'
                },
                bmi: {
                    steps: [
                        'Log in to your BMI account online',
                        'Go to "Royalty Statements"',
                        'Select your statements by date',
                        'Export as CSV or Excel file',
                        'Upload the file to LoopLedger'
                    ],
                    url: 'https://repertoire.bmi.com'
                }
            };
            
            const instruction = instructions[platform];
            if (instruction) {
                const modalContent = document.getElementById('modal-content');
                modalContent.innerHTML = `
                    <div class="space-y-4">
                        <h4 class="text-lg font-medium text-gray-900">How to Export ${platformConfigs[platform].name} Data</h4>
                        
                        <ol class="space-y-2">
                            ${instruction.steps.map((step, index) => `
                                <li class="flex items-start">
                                    <span class="flex-shrink-0 w-6 h-6 bg-indigo-600 text-white text-sm rounded-full flex items-center justify-center mr-3 mt-0.5">
                                        ${index + 1}
                                    </span>
                                    <span class="text-sm text-gray-700">${step}</span>
                                </li>
                            `).join('')}
                        </ol>
                        
                        <div class="flex space-x-3">
                            <button onclick="showManualImport('${platform}')" class="flex-1 bg-gray-300 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-400 transition">
                                <i class="fas fa-arrow-left mr-2"></i>Back
                            </button>
                            <a href="${instruction.url}" target="_blank" class="flex-1 bg-indigo-600 text-white py-2 px-4 rounded-lg hover:bg-indigo-700 transition text-center">
                                <i class="fas fa-external-link-alt mr-2"></i>Open ${platformConfigs[platform].name}
                            </a>
                        </div>
                    </div>
                `;
            }
        }

        function contactSupport(platform) {
            closeModal();
            // This would typically open a support chat or redirect to contact form
            showNotification(`Opening support chat for ${platformConfigs[platform].name} integration...`, 'info');
            
            // Add message to LoopBot
            addChatMessage('system', `I see you need help with ${platformConfigs[platform].name} integration. I can help you get started! What specific information do you need?`);
            
            // Open chat if closed
            const chat = document.getElementById('loopbot-chat');
            if (chat.classList.contains('hidden')) {
                toggleChat();
            }
        }

        function closeModal() {
            document.getElementById('oauth-modal').classList.add('hidden');
        }

        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            const bgColor = {
                success: 'bg-green-500',
                error: 'bg-red-500',
                info: 'bg-blue-500',
                warning: 'bg-yellow-500'
            }[type] || 'bg-blue-500';
            
            notification.className = `fixed top-4 right-4 ${bgColor} text-white px-6 py-3 rounded-lg shadow-lg z-50 transform transition-all duration-300 translate-x-full`;
            notification.innerHTML = `
                <div class="flex items-center">
                    <i class="fas fa-${type === 'success' ? 'check' : type === 'error' ? 'exclamation-triangle' : 'info-circle'} mr-2"></i>
                    <span>${message}</span>
                </div>
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.classList.remove('translate-x-full');
            }, 100);
            
            setTimeout(() => {
                notification.classList.add('translate-x-full');
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 4000);
        }

        // LoopBot Chat Functionality
        function toggleChat() {
            const chat = document.getElementById('loopbot-chat');
            const toggle = document.getElementById('loopbot-toggle');
            
            if (chat.classList.contains('hidden')) {
                chat.classList.remove('hidden');
                toggle.innerHTML = '<i class="fas fa-times text-xl"></i>';
            } else {
                chat.classList.add('hidden');
                toggle.innerHTML = '<i class="fas fa-robot text-xl"></i>';
            }
        }

        function sendMessage() {
            const input = document.getElementById('chat-input');
            const message = input.value.trim();
            
            if (message) {
                addChatMessage('user', message);
                input.value = '';
                
                // Simulate bot response
                setTimeout(() => {
                    const response = generateBotResponse(message);
                    addChatMessage('bot', response);
                }, 1000);
            }
        }

        function addChatMessage(sender, message) {
            const chatMessages = document.getElementById('chat-messages');
            const messageDiv = document.createElement('div');
            messageDiv.className = 'text-sm mb-3';
            
            if (sender === 'user') {
                messageDiv.innerHTML = `<div class="text-right"><span class="bg-indigo-600 text-white px-3 py-2 rounded-lg inline-block">${message}</span></div>`;
            } else {
                messageDiv.innerHTML = `<div class="text-gray-600"><strong>LoopBot:</strong> ${message}</div>`;
            }
            
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function generateBotResponse(message) {
            const responses = {
                'spotify': 'To connect Spotify, click the Connect button on the Spotify card. You\'ll be redirected to Spotify to authorize access to your streaming data.',
                'youtube': 'YouTube integration provides Content ID revenue and analytics data. Make sure you have a YouTube channel with monetization enabled.',
                'ascap': 'ASCAP doesn\'t have a public API yet, so you\'ll need to manually import your royalty statements. I can walk you through the export process.',
                'bmi': 'Similar to ASCAP, BMI requires manual import. You can download CSV files from your BMI account and upload them here.',
                'mlc': 'The MLC integration is already configured! We use their Public Search API to track your mechanical royalties automatically.',
                'api': 'We support several APIs including Spotify Web API, YouTube Analytics API, and The MLC Public Search API. Which platform are you interested in?',
                'help': 'I can help you with platform connections, troubleshooting integrations, or explain how our royalty tracking works. What do you need assistance with?'
            };
            
            const lowerMessage = message.toLowerCase();
            
            for (const [key, response] of Object.entries(responses)) {
                if (lowerMessage.includes(key)) {
                    return response;
                }
            }
            
            return 'I can help you connect your music platforms and track royalties. Try asking about specific platforms like "How do I connect Spotify?" or "Help with ASCAP integration".';
        }

        // Handle Enter key in chat
        document.getElementById('chat-input').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            // Update connected count on page load
            document.getElementById('connected-count').textContent = connectedPlatforms.length;
            
            // Add some demo chat messages
            setTimeout(() => {
                addChatMessage('system', 'Welcome to LoopLedger! I can help you connect your music accounts. Which platform would you like to start with?');
            }, 1000);
        });

        // Navigation
        document.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                
                // Update active nav item
                document.querySelectorAll('.nav-link').forEach(l => {
                    l.classList.remove('text-indigo-600', 'font-medium');
                    l.classList.add('text-gray-500', 'hover:text-gray-900');
                });
                
                this.classList.remove('text-gray-500', 'hover:text-gray-900');
                this.classList.add('text-indigo-600', 'font-medium');
                
                // Handle navigation (in a real app, this would change views)
                const target = this.getAttribute('href').substring(1);
                showNotification(`Navigating to ${target}...`, 'info');
            });
        });
    </script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"94ca3e80de40e277","serverTiming":{"name":{"cfExtPri":true,"cfEdge":true,"cfOrigin":true,"cfL4":true,"cfSpeedBrain":true,"cfCacheStatus":true}},"version":"2025.5.0","token":"4edd5f8ec12a48cfa682ab8261b80a79"}' crossorigin="anonymous"></script>
</body>
</html>
    <script id="html_badge_script1">
        window.__genspark_remove_badge_link = "https://www.genspark.ai/api/html_badge/" +
            "remove_badge?token=To%2FBnjzloZ3UfQdcSaYfDh3LEmaewOJnIu9%2Bsod%2B3L6IvZpj1rpz4LkcJZJ%2BbgRIqJUwAELYAE9%2FqksOXEgs00JT88jSc4RbfEnFSOqZyLyAKK%2Buj0nVx5ApiZp2H%2FkYDJRydIA0ne9dhbk38s3oSFE983VWidkW9HotUUh2XnO%2BLXSl2nx9t9H6n9NNj8FmvY%2BYDuRvLDRv9NX52RhcEB7KLxaUyruzhq1j7HWIWb1DElowsGBFtRpPnXGx9dD33d20b22O%2FAaB%2Ft8UGRAWeSxQPgcN0wUIxpxTNGB7gOmJCMOeD5elMXlv0r3prDRqZARWbIcslBUPUyuwEjq%2Bf%2BsOrcFQgBtAAsGa0A7%2BEXr1jNS%2F51j3ZdLh%2BmTbh5Q0kpXTKjbBmOL47axoIfKL6sCf%2FwbMtLrdMI%2FDI1iDw1MAV%2FU14fj2VPg%2Bqf%2B%2FCpcq5JIgdoIiuw6d%2B1EvMhzvDQuxZsmK8NYHp0zR%2BGLcbT7yEwKaxNRwTfi1eVw88RTf5d%2FhBCCCaJ27zWwCIymIb3VdBYNxI%2Bks6a3yrDZhFfc%3D";
        window.__genspark_locale = "en-US";
        window.__genspark_token = "To/BnjzloZ3UfQdcSaYfDh3LEmaewOJnIu9+sod+3L6IvZpj1rpz4LkcJZJ+bgRIqJUwAELYAE9/qksOXEgs00JT88jSc4RbfEnFSOqZyLyAKK+uj0nVx5ApiZp2H/kYDJRydIA0ne9dhbk38s3oSFE983VWidkW9HotUUh2XnO+LXSl2nx9t9H6n9NNj8FmvY+YDuRvLDRv9NX52RhcEB7KLxaUyruzhq1j7HWIWb1DElowsGBFtRpPnXGx9dD33d20b22O/AaB/t8UGRAWeSxQPgcN0wUIxpxTNGB7gOmJCMOeD5elMXlv0r3prDRqZARWbIcslBUPUyuwEjq+f+sOrcFQgBtAAsGa0A7+EXr1jNS/51j3ZdLh+mTbh5Q0kpXTKjbBmOL47axoIfKL6sCf/wbMtLrdMI/DI1iDw1MAV/U14fj2VPg+qf+/Cpcq5JIgdoIiuw6d+1EvMhzvDQuxZsmK8NYHp0zR+GLcbT7yEwKaxNRwTfi1eVw88RTf5d/hBCCCaJ27zWwCIymIb3VdBYNxI+ks6a3yrDZhFfc=";
    </script>
    
    <script id="html_notice_dialog_script" src="https://www.genspark.ai/notice_dialog.js"></script>
    
